# @package _global_

# Experiment 103: Spatial Encoding
# Tests the impact of explicit spatial coordinate features

defaults:
  - override /data: isic2017
  - override /model: mk_enhanced
  - override /callbacks: default
  - override /trainer: default
  - override /logger: wandb

# Experiment name
experiment_name: "exp103_spatial_encoding"

# Seed
seed: 12345

# Tags for logging
tags: ["exp103", "spatial_encoding", "xyz_radial", "mk_unet", "baseline+spatial"]

# Data configuration
data:
  spatial_mode: "rgb_xyz_radial"  # ✅ Add spatial coordinates
  in_channels: 6  # RGB + X + Y + Radial
  batch_size: 16
  num_workers: 4

# Model configuration - Spatial Encoding ONLY
model:
  net:
    in_channels: 6
    channels: [16, 32, 64, 96]
    use_spatial: true  # ✅ Enable spatial
    use_se: false  # No SE
    deep_supervision: false  # No DS

# Trainer configuration
trainer:
  max_epochs: 50
  accelerator: gpu
  devices: 1
  precision: 16-mixed
  log_every_n_steps: 10
  check_val_every_n_epoch: 1

# Callbacks
callbacks:
  model_checkpoint:
    monitor: "val/dice"
    mode: "max"
    save_top_k: 1
    filename: "epoch_{epoch:03d}_dice_{val/dice:.4f}"
  
  early_stopping:
    monitor: "val/dice"
    patience: 15
    mode: "max"

# Logger
logger:
  wandb:
    project: "umambaspa-lesion"
    name: "exp103_spatial_encoding"
    tags: ${tags}
    notes: "Testing Spatial Encoding - Explicit position-aware features (X, Y, Radial)"
